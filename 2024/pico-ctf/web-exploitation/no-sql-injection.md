# No Sql Injection

## Challenge Description

Can you try to get access to this website to get the flag?

You can download the source [here](https://artifacts.picoctf.net/c\_atlas/34/app.tar.gz).The website is running [here](http://atlas.picoctf.net:53436/).&#x20;

Can you log in?

***

## Solution

First download the given file and extract it.

<figure><img src="../../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

### Analysing the Source Code

On surfing through the given source code, came across the model `user.ts`, which has a key `token` with default value set to `Flag`.

<figure><img src="../../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

If you take a look at the `route.ts` file, they haven't sanitized the input and as well as directly insert the data in the NoSQL query and thus it is vulnerable to No SQL injection. Also on successfully login, the server responds with the entire user object of the user that we have logged in as, which contains the key `token` with the `flag` as value.

<figure><img src="../../../.gitbook/assets/image (28).png" alt=""><figcaption></figcaption></figure>

And also in the `seed.ts` file, found a email id `joshiriya355@mumbama.com`.

<figure><img src="../../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

### No SQL Injection

Since, the challenge name is NoSqlInjection, which gives a hint that the application is vulnerable to No SQL Injection, I tried Authentication bypass using No SQL Injection.

I tried to login with the email id we found and the password as the following No SQL Payload.

```json
{"$ne": null}

// $ne -> not equal to
// The above payload checks whether the value is not equal to null
// Obviously, in our case the password is not going to be null,
// so the condition becomes true and we are successfully logged in.
```

<figure><img src="../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

We have succesfully logged in.

<figure><img src="../../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

### Getting the Flag

I captured the above login request with burpsuite. If you check the response of the above POST request in the HTTP histroy tab of burpsuite, you can see that the entire user object is returned, with the flag encoded in base64 form. After decoding this base64 string, you get the flag.

<figure><img src="../../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

Flag: `picoCTF{jBhD2y7XoNzPv_1YxS9Ew5qL0uI6pasql_injection_a2e0d9ef}`
